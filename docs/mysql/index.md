---
date: 2024-01-02
categories:
  - MySQL
search:
  boost: 2
hide:
  - footer
---

## 什么是 ACID？

ACID 规则原来是在 1970 被 Jim Gray 定义，ACID 事务解决了很多问题，但是仍然需要和性能做平衡协调，事务越强，性能可能越低，安全可靠性和高性能是一对矛盾。

目前主要有两种方式实现 ACID：第一种是 Write ahead logging，也就是日志式的方式。第二种是 Shadow paging。

- **Atomicity 原子性**: 一个事务的所有系列操作步骤被看成是一个动作，所有的步骤要么全部完成要么一个也不会完成，如果事务过程中任何一点失败，将要被改变的数据库记录就不会被真正被改变。
- **Consistency 一致性**: 数据库的约束 级联和触发机制 Trigger 都必须满足事务的一致性。也就是说，通过各种途径包括外键约束等任何写入数据库的数据都是有效的，不能发生表与表之间存在外键约束，但是有数据却违背这种约束性。所有改变数据库数据的动作事务必须完成，没有事务会创建一个无效数据状态，这是不同于 CAP 理论的一致性"consistency".
- **Isolation 隔离性**: 主要用于实现并发控制, 隔离能够确保并发执行的事务能够顺序一个接一个执行，通过隔离，一个未完成事务不会影响另外一个未完成事务。
- **Durability 持久性**: 一旦一个事务被提交，它应该持久保存，不会因为和其他操作冲突而取消这个事务。很多人认为这意味着事务是持久在磁盘上，但是规范没有特别定义这点。

!!!note "InnoDB 引擎通过什么技术来保证事务的这四个特性的呢？"

    - **持久性**是通过 **redo log （重做日志）**来保证的；
    - **原子性**是通过 **undo log（回滚日志）** 来保证的；
    - **隔离性**是通过 **MVCC（多版本并发控制） 或锁机制**来保证的；
    - **一致**性则是通过**持久性+原子性+隔离性**来保证；

## 什么是 CAP？

CAP 是分布式系统中进行平衡的理论，它是由 Eric Brewer 发布在 2000 年。

- **Consistency 一致性**: 同样数据在分布式系统中所有地方都是被复制成相同。
- **Availability 可用性**: 所有在分布式系统活跃的节点都能够处理操作且能响应查询。
- **Partition Tolerance 分区容错性**: 在两个复制系统之间，如果发生了计划之外的网络连接问题，对于这种情况，有一套容错性设计来保证。

在一系列的研究结果里发现，在较大型的分布式系统中，<u>**由于网络分隔，一致性与可用性不能同时满足，这意味着这三个要素只能同时实现两个，不可能三者兼顾**</u>；放宽一致性的要求会提升系统的可用性，提升一致性意味着系统需要牺牲一定的可用性。
